<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AES+RSA加解密可视化工具</title>

    <style>
        .text-wrap label {
            vertical-align: top;
        }
    </style>

</head>

<body>
    <div>
        <h1>加解密</h1>
        <br />
        <div class="text-wrap">
            <label for="decryptData">加密前数据：</label>
            <textarea id="decryptData" cols="100" rows="10"></textarea>
        </div>
        <div class="text-wrap">
            <label for="encryptData">加密后数据：</label>
            <textarea id="encryptData" cols="100" rows="10"></textarea>
        </div>


        <div style="margin-top: 20px;">
            <button id="encryptButton">加密</button>
            <button id="decryptButton">解密</button>
        </div>
        <hr />
        <h1>图片回显</h1>
        <br />
        <div class="text-wrap">
            <label for="encryptImgData">加密后数据：</label>
            <textarea id="encryptImgData" cols="100" rows="10"></textarea>
        </div>
        <button id="decryptImgButton">回显图片</button>
        <div><img id="decryptImg" width="900" src="" alt="解密图片"></div>
    </div>

    <script type="module">
        import { encrypt, decrypt } from './dist/index.js'


        // // 请求前加密数据
        // let data = { "username": "a", "email": "湿时说" }
        // const encryptData = await encrypt(JSON.stringify(data))
        // console.log('加密数据：', encryptData)


        // // 解密后端返回数据
        // const responseText = `JEbzgX25YHwVKU8nhN6n/ACB8mhV48xyXXa8HW1zg0rFm60dO6SsMUcK4LWtnKqTcnDvWC9piqBP6lO2/iRcrGxbR7vGDyNluuwXXv8lk7HyjRM7B6wJe2p3rO52zATzJvbUktQMx024Aw818yNZ9EKn8XiKYD/6wimSiQ/6I2mIsgi799E45rgy8trJGmtY9FIG6TX8HuaZ5Q+BEuFDrA6eq4jyVCKsQthmqJ70on52LVDiBD/lRY8xF2hMgq4evXfBeNV7xr/TncexqvokQDTgakCVDJkWKuOx91EuBaGbFwr032+mR/i+2f5Gc2o1pLRP77yQZN30AmLb2o9/Nsk6I34nXZQwtgTpU3QCXGbp9QXVRvqdFVmXc5Wizz8WEsBptDd7KnXtDvj0mfG5nr6YrPFoFVOqGHBFALNYPYwnfzqsT+HuB/Be1MgeZl3tIjWqvcRLFEGOrbZBzWQIko32FloSC8EA2RZXLa/QVE4C2pptGqB6ODmiMrqJpBMoizyloOIrAp1nhns+uL3t7K6UWMw/Wy6Q1rpRDZvS/S6xi0i2iqo6igOpToyUC7CvUPYShWewsDnvKO+en/W1qe35uHnM0U/FzRQSA8vaJD9cFB8ZVIgEFbaXDKKSIiBkFOFtGdGWsNPvfO64kxYWYPeBfsS97WLw7mQSgwV1AjqVAKRhIU+w5XxDE7KKsSxRpY0uY6Ag2bQaGOB/cGgNdG/oPnI0FNfuLpSyGBuSVZ372ggs/CBITSfDYyHEkqX8tT4rzUGhdiu+l/+Hp+mf787dEQ/A5jKultwZS4t9hAlkiP0R8+qNEVVzT8wjCMpVXcT75y5sF+4FBGcGWYkROwvlJrmdveIuVE3hwaQSFXeQ+cNwf2AnpHPEUkiHOVDKlt528eM8JIw0YyYn1+slq88B`
        // const decryptData = await decrypt(responseText)
        // console.log('解密数据：', decryptData)
        // const res = JSON.parse(decryptData)
        // if (res.code === 1001) {
        //     console.log(res.data)
        // }

        document.querySelector('#encryptButton').addEventListener('click', async () => {
            const decryptText = document.querySelector('#decryptData').value || ''
            const encryptData = await encrypt(decryptText)
            document.querySelector('#encryptData').value = encryptData
        })
        document.querySelector('#decryptButton').addEventListener('click', async () => {
            const encryptText = document.querySelector('#encryptData').value || ''
            try {
                const decryptData = await decrypt(encryptText)
                document.querySelector('#decryptData').value = decryptData
            } catch (error) {
                alert('解密失败')
            }

        })


        // 回显图片
        function showImg(base64str) {
            const imgDom = document.querySelector('#decryptImg')
            imgDom.src = `data:image/gif;base64,${base64str}`
        }
        document.querySelector('#decryptImgButton').addEventListener('click', async () => {
            const imgEncryptBase64Text = document.querySelector('#encryptImgData').value || ''
            try {
                const decryptText = await decrypt(imgEncryptBase64Text)
                const res = JSON.parse(decryptText)
                if (res.code === 1001) {
                    showImg(res.data)
                }
            } catch (error) {
                alert('解密失败')
            }

        })
        

    </script>
</body>

</html>