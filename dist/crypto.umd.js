(function(s,u){typeof exports=="object"&&typeof module!="undefined"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(s=typeof globalThis!="undefined"?globalThis:s||self,u(s["@wyny/crypto"]={}))})(this,function(s){"use strict";function u(t){var e=String.fromCharCode.apply(null,Array.from(new Uint8Array(t))),n=decodeURIComponent(e);return n}function f(t){const e=encodeURIComponent(t),n=e.split(""),r=[];for(let o=0;o<n.length;o++)r.push(n[o].charCodeAt(0));return new Uint8Array(r)}function a(t){for(var e="",n=new Uint8Array(t),r=n.byteLength,o=0;o<r;o++)e+=String.fromCharCode(n[o]);return window.btoa(e)}function c(t){const e=window.atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}const h=t=>new BigUint64Array([BigInt(t)]).buffer,l=(...t)=>{let e=0;for(let o of t)e+=o.byteLength;let n=new Uint8Array(e),r=0;for(let o of t){let i=new Uint8Array(o);n.set(i,r),r+=o.byteLength}return n.buffer},y={name:"AES-CTR",length:128};async function K(t){try{const e=await window.crypto.subtle.exportKey("raw",t);return`${a(e).replace(/[^\x00-\xff]/g,"$&").replace(/.{64}\x01?/g,`$&
`)}`}catch(e){console.log(e)}return null}function w(t){const e=c(t);return window.crypto.subtle.importKey("raw",e,y.name,!0,["encrypt","decrypt"])}const S=async()=>{let t=await window.crypto.subtle.generateKey({name:y.name,length:y.length},!0,["encrypt","decrypt"]);return K(t)},m=async(t,e,n)=>{const r=await w(t),o=await window.crypto.subtle.encrypt({name:y.name,counter:c(n),length:y.length},r,e);return a(o)},I=async(t,e,n)=>{const r=await w(t);return await window.crypto.subtle.decrypt({name:y.name,counter:c(n),length:y.length},r,c(e))},A={name:"RSA-OAEP",hash:{name:"SHA-256"}},d={PRIVATE_KEY:"MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCHQrZ0kuI9midV2Ky08TIdxDbL6wsiQcsApG90SIZhWBCs42lfX8Gvyn7RRBKw9KoYRwshybLbnfLKEb/t9BS0zKtzxnLOL2GAXhSgNWXAV7YMQuiy9ScvpS2uiBL6OA7eP5+qmRtGh41FZs9GbTiYg2AvpZkgvnJsALP3TteRXoujVnq3MKTZpzfcFAiHIdWz9gIhZYfWRnZUamHK3Xyiysk/6QLs3n8nXjDRc2UyOVUmryl4uhNJ8p/Q3AnlXtWpyT3yImq/JS8/L7GRUuDD9EOdlngAlkcDp1gCfclJQcyoTsA6Yc1p0p3NmcbVWeUGZ9O3SsjEW2ckwNpaWDe5AgMBAAECggEAAfZ23VQwUkKFZZqCTxHc70+kl+ruO24G+xhnwaE3yfvUKh4WrlqeXeWrV3AMcWLrgPSu9auOm9874bDGPza2gjUiG8j6a4GGga1b0UNVGahsLNtfsxEZo3hbJFg3Jkhf9tunfntASRK4exRV16jIFHZ7k9VsVmxNDsIn2mPbfvGBv1yCtlsuCiBlZ58faQzitQmuhd+N50OV6M8+3NIwgOKp9VTWqHEWIU9INxaTtoplL3x7u9nkuN9Hn5Y2XQGKulxyVduj549v9/3Wh41GpisQvK4fQxs9erg+bUy+mCUr8k5TFh9WdpJ+gF2dX2LTpodoKH0Up6ZtV2usQ5s9gQKBgQDnrKaKM1rvLqVIJjdECg/ygdkOpwgsNsZCS3Mb0eAJcaZAs7sotMGiVj+c4Qe+QbwnLILqW83ggrBK/YhpL0Nn1nGorFTkEb7yGBv4AzITl2WjSInirjjD4ALvrM6o6s60w/Olp/MMrCenH0aX3ZG+jQu61miFyPfzw5m127F+kQKBgQCVdnuyXi1b8fTfSPetj5B44t3PQdBcv6wI27NBpcvU4005Iz/kGpITWxpmE72KGrkDeiCcs4AZRLOG7ko4NOvamsPhGjNYDa1ukXWR4RdTYWUyTUfSGOR89Wp9/ias6n3WFLy22exOoOA+UsTaLDhkj6/mTH7kTKlxRFh9QJoKqQKBgE3nmuEiP9PqZZ4La84vbAlqbKkmtfLYQHcOlBiozKOgWf2r8qXPksWaJy4D5eyugizSJPvV/zcd+1ZcR0DHqe0DCZlkye8foIwcW1tdB7vaz0zHGcbmOyRy8cnS3HOk8fmLYyUzguGiCnuCYuSyl03ydB1R+Df0ypxoDApBZEBhAoGAePUwWkPZVaXU1LdKqo2bEBoaBFdw9v6vjWOwCJrTAPELWAhs9n+CZGPAU4f6RsAlpui5Z9fk/Y4Z9EL4kdBSZ9IEYDJCByrahrb1fR+7LuGNck4Up7U5hN9gVaLPTfVf7VdO+nQWx/NuR0HYyfArm0alxi12K/DW2DHFo2gawjECgYAIfSyU+9YmqGiRmBb8VGh8lx8SpL0f0iOjTBZnSNPtRUSLMwCnATBvscUsVpYCaUvDVDwsVdvk5XxZ53Kp6UZHyWqTiskI7LT4dioIdbQfuW2gC2KJjMzCOcjAfS+9GyUhhA1Y1mlv5rscqMPNMwOkOJtBIDXZcI5+oIb0DL1FUw==",PUBLIC_KEY:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAh0K2dJLiPZonVdistPEyHcQ2y+sLIkHLAKRvdEiGYVgQrONpX1/Br8p+0UQSsPSqGEcLIcmy253yyhG/7fQUtMyrc8Zyzi9hgF4UoDVlwFe2DELosvUnL6UtrogS+jgO3j+fqpkbRoeNRWbPRm04mINgL6WZIL5ybACz907XkV6Lo1Z6tzCk2ac33BQIhyHVs/YCIWWH1kZ2VGphyt18osrJP+kC7N5/J14w0XNlMjlVJq8peLoTSfKf0NwJ5V7Vqck98iJqvyUvPy+xkVLgw/RDnZZ4AJZHA6dYAn3JSUHMqE7AOmHNadKdzZnG1VnlBmfTt0rIxFtnJMDaWlg3uQIDAQAB"},L={PUBLIC_KEY:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAh0K2dJLiPZonVdistPEyHcQ2y+sLIkHLAKRvdEiGYVgQrONpX1/Br8p+0UQSsPSqGEcLIcmy253yyhG/7fQUtMyrc8Zyzi9hgF4UoDVlwFe2DELosvUnL6UtrogS+jgO3j+fqpkbRoeNRWbPRm04mINgL6WZIL5ybACz907XkV6Lo1Z6tzCk2ac33BQIhyHVs/YCIWWH1kZ2VGphyt18osrJP+kC7N5/J14w0XNlMjlVJq8peLoTSfKf0NwJ5V7Vqck98iJqvyUvPy+xkVLgw/RDnZZ4AJZHA6dYAn3JSUHMqE7AOmHNadKdzZnG1VnlBmfTt0rIxFtnJMDaWlg3uQIDAQAB"};function g(t,e){const n=c(t);return window.crypto.subtle.importKey(e?"pkcs8":"spki",n,{name:A.name,hash:A.hash},!0,[e?"decrypt":"encrypt"])}const B=(t,e,n)=>{const r=c(t);return window.crypto.subtle.importKey(e?"pkcs8":"spki",r,{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,n)},E=async t=>{const e=await B(d.PRIVATE_KEY,!0,["sign"]);if(e!==null){let n=await window.crypto.subtle.sign("RSASSA-PKCS1-v1_5",e,f(t));return a(n)}return null},C=async(t,e)=>{const n=await g(t,!1);if(n!==null){const r=await window.crypto.subtle.encrypt({name:A.name},n,e);return a(r)}return""},k=async(t,e)=>{const n=await g(t,!0);return n!==null?await window.crypto.subtle.decrypt({name:A.name},n,e):new ArrayBuffer(0)},U=async t=>{const e=await E(t)||"",n=Date.now(),r=l(h(n),c(e),f(t)),o=await S()||"",i=a(window.crypto.getRandomValues(new Uint8Array(16)));let b=await m(o,r,i);const p=await C(L.PUBLIC_KEY,c(o))||"",Z=l(c(i),c(p),c(b));return a(Z)},V=async t=>{const e=c(t),n=e.slice(0,16),r=e.slice(16,16+256),o=e.slice(16+256),i=await k(d.PRIVATE_KEY,r),p=(await I(a(i),a(o),a(n))).slice(8+256);return u(p)};s.decrypt=V,s.encrypt=U,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=crypto.umd.js.map
