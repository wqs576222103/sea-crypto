<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AES+RSA加解密可视化工具</title>

    <style>
        .text-wrap label {
            vertical-align: top;
        }

        .flex1 {
            display: flex;
            align-items: center;
        }

        .text-wrap textarea {
            width: 100%;
        }

        .flex1 div:nth-child(2) {
            text-align: center;
            vertical-align: middle;
            margin: 0 20px;
        }
    </style>
    <script>
        window.PRIVATE_KEY = `MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCev3EPpZo8zx9S63aZoae7fj8pHBSFyHXIRM7b94SoP6izO4tyhjKGU96MODdTwCyik6V8siyj6GZQM4+Vh9riI2F0U6ufOCaYXT2drjTQp4GlBnQPBJ+coSUFw0tjiJWRSyVIhfIg24feKGljkd9FM5hp/sWpS1xvaCTTHXP5yrTt2UwKZ5qRz3BpZ3+kEiQfdLJqX8CoHzb+bSTO2nViKbIW3s6StJrMSj68UrunNON46lR5JHe9EDfhw9SRpv4IitAuHOAwZ38/RlGwHAiC4J6aYQ3SbxGEsLUywsn0ZclN1R0tvSPSqNZwQiarlplH+fE55449ItUIa+qnyNHdAgMBAAECggEAULAf6IMU3XmtgzkZhEcteVhXBC84ozNb4ppOxnGN5PLObaODYoehYLN6d60POiuAxHXldHcfx4QVlQhQIAH4mF7BZx4sKnag72rdKatlPvUVKWsZTJTeB//EUKSOSh4fX8VhQvaKNnc/HQVPZAO+B2+NNbsAfudGKX420XO0Ai9fQMzvmqcmkXFoMw67uwrPjAO7/92+qk1U2/K7seI6SXqSTcJyDOiS1GaruXey1FiKqV2Ewos5nv9isp0ElIAq435SSFJttSaVgZSW7uNzFFPSapQR8HrleOxLnOeHn3sxNqJIYRq+OgexmQThDSEvU9G0HTu1fw8pXkBC3WF9RQKBgQDfGKJZNtHQmC6GPjt7UunD70VGs5uWI3XX9cdUYBmN80z950MaDgiiIuSPOaIxmQ3PUDBcDQnXdnECSkkWkFyZA6pMIJ7pUUnFraNuT0ZllNYGSYxLzzDrzb4jtI3qojBBctmNa/8rv+9v6bafhbKMIdMO2OR/fYMktbdvMX86XwKBgQC2KTosVm8xREJd+PsSX/h0TTW66466Jz2viJfcVwHLzqSqWK/xDSurdu7DvpOkDcXyMvogBAQ3BLLa3GEGtdMKj0zgzrjTHaPnDGAECVYON1vEeq5AVEivHHJz6UxI8huUjXdoWiFELFjczV4hlrT93vTYx9sgrgUNdsJGtsVVQwKBgQCGmIMiFevB0H6JKTSTs7MrLcj63dNpYl1vfG3U3uGr/XSe3o5iQsM8ppaEPn43NCLbx4JVltwwLNoDSrQLs+7ZthdhNHELTKqYY6jtHVDYalIxmt/UwNy/9vHW8tCIFW/NnK/aHaTmTTb0qukuFuhgmOuP0pUQwbWESUmxAQjEOwKBgHRdR70VBfjZ2u9+4pwtVGCvBdi/KzC9aolcX24w4oPYIJZ1CweYW0IwOnwunM/awI1khSW4ixy+Uqa+yvhnZEZFnl2pkKXENHSfEiLh9+gi8utDV1bewIOkT3S+Hq4mgvnVmOa/VKrhDW8Xfb9FL59RMuXcXZ21rKKaL6bOkKZTAoGASc9Yst39DUihR6oWB/nj/PdubFv+6t6bJ/mH6atkvGCMVR4Uf+qMhmGZaATFTr9B57AueyDQER4y+n43V2MWR1jCxfcJU96dMLZnIkgnHUWpfX68dmy1Qwb6ik1OiBRjCwwFOl4H+rVt8BTRxNQa5XbdyR4iUM9xYh3VQLk2W9U=`
        window.PUBLIC_KEY = `MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqNry+b+4Y0CRr7vWEhguXMa6KMmV1UjkVOhHFD3VkhQfWyqO2qJi95uFNE1ZgTprnEbh2w1lAY88wAnWGZD8LtR7N+qzoBLfF+/HBPBTVjxSaXZwBkUdCrcK87EzPdPdtvQ1BtsWMB3j5X9cQateQJjOBXEymqnIz980+zjE5rpfDJmB6lhYn/d/2gh8neoRN/6NY4UGtX5RSb4oDMXBhgnQKf2dTEGY0ISDe8GBUUS6YO3ftBVxtcYPmFcX8xM55462V30bIBpFBL/MNAjoOPYWP/uJ1vTEUCwzWDh7HSrlRWkk7ke/O5voKC07X8cyGJ3BSidN+6UXmWCwTMD8IwIDAQAB`
    </script>
</head>

<body>
    <div>
        <h1>加解密</h1>
        <div class="flex1">
            <div class="text-wrap">
                <p for="decryptData">加密前数据：</p>
                <textarea id="decryptData" cols="90" rows="20"></textarea>
            </div>
            <div>
                <div>
                    <button id="encryptButton">加密&rarr;</button>
                </div>
                <br />
                <div>
                    <button id="decryptButton">&larr; 解密</button>
                </div>
            </div>
            <div class="text-wrap">
                <p for="encryptData">加密后数据：</p>
                <textarea id="encryptData" cols="90" rows="20"></textarea>
            </div>
        </div>

        <br />

        <hr />
        <h1>图片回显</h1>
        <div class="flex1">
            <div class="text-wrap">
                <p for="encryptImgData">加密后数据：</p>
                <textarea id="encryptImgData" cols="90" rows="20"></textarea>
            </div>
            <div>
                <button id="decryptImgButton">回显图片</button>
            </div>
            <div><img id="decryptImg" width="600" src="" alt="回显图片"></div>
        </div>
    </div>

    <script type="module">
        import { encryptWithKey, decryptWithKey } from './crypto.es.js'

        document.querySelector('#encryptButton').addEventListener('click', async () => {
            const decryptText = document.querySelector('#decryptData').value.trim() || ''
            const encryptData = await encryptWithKey(PRIVATE_KEY, PUBLIC_KEY, decryptText)
            document.querySelector('#encryptData').value = encryptData
        })
        document.querySelector('#decryptButton').addEventListener('click', async () => {
            const encryptText = document.querySelector('#encryptData').value.trim() || ''
            try {
                const decryptData = await decryptWithKey(PRIVATE_KEY, PUBLIC_KEY, encryptText)
                document.querySelector('#decryptData').value = decryptData
            } catch (error) {
                console.log(error)
                alert('解密失败')
            }

        })


        // 回显图片
        function showImg(base64str) {
            const imgDom = document.querySelector('#decryptImg')
            imgDom.src = `data:image/gif;base64,${base64str}`
        }
        document.querySelector('#decryptImgButton').addEventListener('click', async () => {
            const imgEncryptBase64Text = document.querySelector('#encryptImgData').value || ''
            try {
                const decryptText = await decryptWithKey(PRIVATE_KEY, PUBLIC_KEY, decryptText)
                const res = JSON.parse(decryptText)
                if (res.code === 1001) {
                    showImg(res.data)
                }
            } catch (error) {
                console.log(error)
                alert('解密失败')
            }

        })


    </script>
</body>

</html>