<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AES+RSA加解密可视化工具</title>

    <style>
        .text-wrap label {
            vertical-align: top;
        }

        .flex1 {
            display: flex;
            align-items: center;
        }

        .text-wrap textarea {
            width: 100%;
        }

        .flex1 div:nth-child(2) {
            text-align: center;
            vertical-align: middle;
            margin: 0 20px;
        }
    </style>

</head>

<body>
    <div>
        <h1>加解密</h1>
        <div class="flex1">
            <div class="text-wrap">
                <p for="decryptData">加密前数据：</p>
                <textarea id="decryptData" cols="90" rows="20"></textarea>
            </div>
            <div>
                <div>
                    <button id="encryptButton">加密&rarr;</button>
                </div>
                <br />
                <div>
                    <button id="decryptButton">&larr; 解密</button>
                </div>
            </div>
            <div class="text-wrap">
                <p for="encryptData">加密后数据：</p>
                <textarea id="encryptData" cols="90" rows="20"></textarea>
            </div>
        </div>

        <br />

        <hr />
        <h1>图片回显</h1>
        <div class="flex1">
            <div class="text-wrap">
                <p for="encryptImgData">加密后数据：</p>
                <textarea id="encryptImgData" cols="90" rows="20"></textarea>
            </div>
            <div>
                <button id="decryptImgButton">回显图片</button>
            </div>
            <div><img id="decryptImg" width="600" src="" alt="回显图片"></div>
        </div>
    </div>

</body>
<script src="https://cdn.bootcss.com/eruda/1.5.8/eruda.min.js"></script>
<script>
    eruda.init();
    console.log('控制台打印信息');
</script>
<script>
    window.PRIVATE_KEY = `MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCuxD2Ziks7+i3nVC5IQDzAuiapy9TFcyX2CFCEvxDJ8nmmxUPOEPCEcB8K4WkB97fW1UsknqfCGbjRCWkjEqLEcn1eWtTP9Gr1q4XXnAX4NFnsTK2iOjwcv9SuLkzj9VXbQK27Xamy7gvPgZjIxAwBU2N7ptqDMlSgu+OzHU/eKt9j7nCFjWF0+lxqQVHfi3BNBZSjT+57ipSX29mlNvA5NGBhAsISj7pf18vpPse3yTaSG8j03KhVkp6CItmex97XC9qKYgYjgGO7zkK9O5Q/HR4wTnOyOeP5aiKIu2MmcJx+yq0vpresAWGiiu6fXGM5uAH7yUqer9rsCOk0pPhBAgMBAAECggEAXY+HXsRvhHtpybcCVAG3xIGjozERBmefwfgvivFyvnpF8CcZJp9g87XGmJ+WBMymKafkY4VgUARPMfF0zKb0ZnDYdwPvfCjgfgbGT2gitf7oyR0/s2Kzvbxg0qLM3RkBTrBwkacR602PGxbJQWna93a6An+P6b6vGaGcw84EbO3ndmI6/qle7aCt3Fig82EwddlRUKvk249Wt6UwKC5NQGZO6/DonksSCLYUPv+ruIUEnqsNbqZ3f3csRM9a75lP6l455mH7VlejB/0rd4PUIif3CEar6X4L2wdOuzAzMTEKaj/x9Oqg/SgSMGSt6q/Er1m44GYXDWmawDkrSM0nRQKBgQD351bxndfuc0sykWVu9VTs5r37kS8g6ErjhEjjPp67Nf7/ScjDpcglR74b/jXCdhOz7dtjjjyj1mGZVH3iiOQBQr98MIYqsp18QNcfcAeDLUqwHPI2q998eyOjK2AugEWIVj1kQtfDPrcWnUk4FJG2qlsK63sVEO5WiDeSNeO4WwKBgQC0eWuGG4xX6Dq4p8G7u3Z7wn7LlcOSKcpEHBNESfWhD+/a8QmdELxX4oVVbs309klNHcVcVVrWdpsXo4QPPMsn1rmnkU5oc7e0sRFlGNVyh6sI0cYNQqM+S9rcPw+6KoTbylJIiDL4MYnHJ1NH6o+47yKIVIOYSYVc8ijjOmEUkwKBgQCtOQd1uZfC1Ok8ooBAMklvaCRkfqRx2B9ML4lG0ODVa/uMoyAYJeVet2zN3qnuAdfuqEvemusgiJKWM4XrH0BC6UMoIjf96eVFh4FKRFvbe3Bu8ysErMBzGRBj2dFRbOwpQimPv21Izq/cq3cYKrdO7mbDkJvmsnf4GyLJlcJTdQKBgCeFr5Ze0g0uPi3SDwsdsoTHwxyyX3HS1Qi1XULHL5Nl+hDoWEKdN6HHaYucCF5s0QCiVGY0CwCMWMqEdJchqRvAWkfn+lPFg6V+YWDSX2wFad80kTq2LSmnUvaImNkcFpxLYlmf+gmAT7vdUM+e/npxZA6W83qWHy6LmYipcDkhAoGAfaNCwKQnc7IVRXqcDWAAgHPgF9ySRmLi0ofN1Y8CdD99/pkaC7CkktTobtPUZhEG1wXvHyPf8ADhao0Azc3tXSn3cGo7NHEA/Jl9FqkLpI+7OemvUT4cegFUAcfBfcYxW8TtaWfUIkCPDVbkUj0wuTqQv3N0qud2Q0SCoS1cO/c=`
    window.PUBLIC_KEY = `MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqNry+b+4Y0CRr7vWEhguXMa6KMmV1UjkVOhHFD3VkhQfWyqO2qJi95uFNE1ZgTprnEbh2w1lAY88wAnWGZD8LtR7N+qzoBLfF+/HBPBTVjxSaXZwBkUdCrcK87EzPdPdtvQ1BtsWMB3j5X9cQateQJjOBXEymqnIz980+zjE5rpfDJmB6lhYn/d/2gh8neoRN/6NY4UGtX5RSb4oDMXBhgnQKf2dTEGY0ISDe8GBUUS6YO3ftBVxtcYPmFcX8xM55462V30bIBpFBL/MNAjoOPYWP/uJ1vTEUCwzWDh7HSrlRWkk7ke/O5voKC07X8cyGJ3BSidN+6UXmWCwTMD8IwIDAQAB`
</script>
<script type="module">
    import { encryptWithKey, decryptWithKey } from './crypto.es.js'

    document.querySelector('#encryptButton').addEventListener('click', async () => {
        const decryptText = document.querySelector('#decryptData').value.trim() || ''
        const encryptData = await encryptWithKey(PRIVATE_KEY, PUBLIC_KEY, decryptText)
        document.querySelector('#encryptData').value = encryptData
    })
    document.querySelector('#decryptButton').addEventListener('click', async () => {
        const encryptText = document.querySelector('#encryptData').value.trim() || ''
        try {
            const decryptData = await decryptWithKey(PRIVATE_KEY, PUBLIC_KEY, encryptText)
            document.querySelector('#decryptData').value = decryptData
        } catch (error) {
            console.log(error)
            alert('解密失败')
        }

    })


    // 回显图片
    function showImg(base64str) {
        const imgDom = document.querySelector('#decryptImg')
        imgDom.src = `data:image/gif;base64,${base64str}`
    }
    document.querySelector('#decryptImgButton').addEventListener('click', async () => {
        const imgEncryptBase64Text = document.querySelector('#encryptImgData').value || ''
        try {
            const decryptText = await decryptWithKey(PRIVATE_KEY, PUBLIC_KEY, imgEncryptBase64Text)
            const res = JSON.parse(decryptText)
            if (res.code === 1001) {
                showImg(res.data)
            }
        } catch (error) {
            console.log(error)
            alert('解密失败')
        }

    })


</script>

</html>